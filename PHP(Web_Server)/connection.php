<?php
	error_reporting(1);


	$con = mysqli_connect('localhost', 'root', 'password');
	
	
	$check = "SELECT SCHEMA_NAME FROM INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME = 'school'";
	$result = mysqli_query($con, $check);
	$count = mysqli_num_rows($result);  

	if($count === 0)
	{
		$command = " CREATE DATABASE school; USE school;  CREATE TABLE `assignment` (   `Module_ID` int(8) NOT NULL,   `ID` int(8) NOT NULL,   `Due` datetime NOT NULL,   `Question` varchar(4096) NOT NULL,    PRIMARY KEY (`ID`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;   CREATE TABLE `class` (   `ID` int(8) NOT NULL,   `Name` varchar(255) NOT NULL,   `Description` varchar(2048) NOT NULL,   `Hours` tinyint(1) NOT NULL,   `Course_Branch` varchar(8) NOT NULL COMMENT 'this is the course offering (Example : ECE Or CMP_SC',   `Course_Number` int(8) NOT NULL,   `Professor_id` int(8) DEFAULT NULL,  PRIMARY KEY(`ID`),  UNIQUE (`ID`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;  CREATE TABLE `class_enrolled_in` (   `Class_ID` int(8) NOT NULL,   `User_ID` int(8) NOT NULL,   `Grade` int(3) DEFAULT NULL,    PRIMARY KEY (`Class_ID`,`User_ID`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;   CREATE TABLE `hw_turned_in` (   `User_ID` int(11) NOT NULL,   `Assignment_ID` int(8) NOT NULL,   `Stamp` datetime NOT NULL,   `Work` varchar(4096) NOT NULL,   `Grade` int(3) DEFAULT NULL,   `Graded_By` int(11) DEFAULT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;   CREATE TABLE `modules` (   `Class_id` int(8) NOT NULL,   `Creator_id` int(8) NOT NULL,   `ID` int(8) NOT NULL,   `Name` varchar(255) NOT NULL,   `Description` varchar(1024) NOT NULL ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;  CREATE TABLE `test` (   `Module_ID` int(8) NOT NULL,   `ID` int(8) NOT NULL,   `Due` datetime NOT NULL,   `Time_Limit` int(8) DEFAULT 60 ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;  CREATE TABLE `test_question` (   `Test_ID` int(8) NOT NULL,   `ID` int(8) NOT NULL,   `Question` varchar(1024) NOT NULL,   `Answer` int(8) NOT NULL,    PRIMARY KEY (`Test_ID`,`ID`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;  CREATE TABLE `test_question_options` (   `Test_ID` int(8) NOT NULL,   `Question_ID` int(8) NOT NULL,   `ID` int(8) NOT NULL,   `_Option` varchar(1024) NOT NULL,    PRIMARY KEY (`Test_ID`,`Question_ID`,`ID`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;  CREATE TABLE `test_turned_in` (   `Test_ID` int(8) NOT NULL,   `User_ID` int(8) NOT NULL,   `Stamp` datetime NOT NULL,   `Grade` int(3) DEFAULT NULL,    PRIMARY KEY (`Test_ID`,`User_ID`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT='helper';  CREATE TABLE `test_turned_in_answers` (   `Test_ID` int(8) NOT NULL,   `User_ID` int(8) NOT NULL,   `Question_ID` int(8) NOT NULL,   `Response` int(8) NOT NULL,    PRIMARY KEY (`Test_ID`,`User_ID`,`Question_ID`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;  CREATE TABLE `user` (   `ID` int(8) NOT NULL,   `First` varchar(255) NOT NULL,   `Last` varchar(255) NOT NULL,   `Email` varchar(255) NOT NULL,   `Password` varchar(255) NOT NULL,   `Rank` int(8) NOT NULL DEFAULT 0, PRIMARY KEY(`ID`), UNIQUE(`ID`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;    ALTER TABLE `hw_turned_in`   ADD PRIMARY KEY (`User_ID`,`Assignment_ID`),   ADD KEY `Assignment_ID` (`Assignment_ID`);  ALTER TABLE `modules`   ADD PRIMARY KEY (`ID`),   ADD KEY `ID` (`ID`),   ADD KEY `Class_id` (`Class_id`),   ADD KEY `Creator_id` (`Creator_id`);  ALTER TABLE `test`   ADD PRIMARY KEY (`ID`),   ADD UNIQUE KEY `ID` (`ID`),   ADD UNIQUE KEY `Module_ID` (`Module_ID`);    ALTER TABLE `assignment`   MODIFY `ID` int(8) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=0;  ALTER TABLE `class`   MODIFY `ID` int(8) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=0;  ALTER TABLE `modules`   MODIFY `ID` int(8) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=0;  ALTER TABLE `test`   MODIFY `ID` int(8) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=0;  ALTER TABLE `user`   MODIFY `ID` int(8) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=0;  ALTER TABLE `assignment`   ADD CONSTRAINT `Module Constraint` FOREIGN KEY (`Module_ID`) REFERENCES `modules` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;  ALTER TABLE `class`   ADD CONSTRAINT `Teacher Gone` FOREIGN KEY (`Professor_id`) REFERENCES `user` (`ID`) ON DELETE SET NULL ON UPDATE CASCADE;  ALTER TABLE `class_enrolled_in`   ADD CONSTRAINT `Class Dependency` FOREIGN KEY (`Class_ID`) REFERENCES `class` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,   ADD CONSTRAINT `User Dependency` FOREIGN KEY (`User_ID`) REFERENCES `user` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;  ALTER TABLE `hw_turned_in`   ADD CONSTRAINT `a` FOREIGN KEY (`User_ID`) REFERENCES `user` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,   ADD CONSTRAINT `b` FOREIGN KEY (`Assignment_ID`) REFERENCES `assignment` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;  ALTER TABLE `modules`   ADD CONSTRAINT `c` FOREIGN KEY (`Class_id`) REFERENCES `class` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,   ADD CONSTRAINT `d` FOREIGN KEY (`Creator_id`) REFERENCES `user` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;  ALTER TABLE `test`   ADD CONSTRAINT `e` FOREIGN KEY (`Module_ID`) REFERENCES `modules` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;  ALTER TABLE `test_question`   ADD CONSTRAINT `f` FOREIGN KEY (`Test_ID`) REFERENCES `test` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;  ALTER TABLE `test_question_options`   ADD CONSTRAINT `g` FOREIGN KEY (`Test_ID`) REFERENCES `test` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;  ALTER TABLE `test_turned_in`   ADD CONSTRAINT `h` FOREIGN KEY (`Test_ID`) REFERENCES `test` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,   ADD CONSTRAINT `i` FOREIGN KEY (`User_ID`) REFERENCES `user` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;  ALTER TABLE `test_turned_in_answers`   ADD CONSTRAINT `j` FOREIGN KEY (`User_ID`) REFERENCES `user` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,   ADD CONSTRAINT `k` FOREIGN KEY (`Test_ID`) REFERENCES `test` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;  ";
		$db = mysqli_multi_query($con, $command);
		while (mysqli_next_result($con));		
	}

	mysqli_select_db($con, 'school');

		
	
?>
